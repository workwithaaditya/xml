5)

#include "ns3/core-module.h"
#include "ns3/network-module.h"
#include "ns3/internet-module.h"
#include "ns3/point-to-point-module.h"
#include "ns3/applications-module.h"
#include "ns3/netanim-module.h"
#include "ns3/ipv4-global-routing-helper.h"


using namespace ns3;

int main(int argc, char *argv[])
{
  CommandLine C;
  C.Parse(argc, argv);

  NodeContainer N;
  N.Create(2);                      // n0 = client, n1 = server

  NodeContainer R;
  R.Create(4);                      // r0, r1, r2, r3

  InternetStackHelper S;
  S.Install(N);
  S.Install(R);


  PointToPointHelper P;
  P.SetDeviceAttribute ("DataRate", StringValue("5Mbps"));
  P.SetChannelAttribute ("Delay", StringValue("2ms"));


  NetDeviceContainer D0 = P.Install(N.Get(0), R.Get(0));
  NetDeviceContainer D1 = P.Install(R.Get(0), R.Get(1));
  NetDeviceContainer D2 = P.Install(R.Get(1), R.Get(2));
  NetDeviceContainer D3 = P.Install(R.Get(2), R.Get(3));
  NetDeviceContainer D4 = P.Install(R.Get(3), N.Get(1));


  Ipv4AddressHelper A;
  A.SetBase("10.1.1.0", "255.255.255.0");
  Ipv4InterfaceContainer I0 = A.Assign(D0);
  A.SetBase("10.1.2.0", "255.255.255.0");
  Ipv4InterfaceContainer I1 = A.Assign(D1);
  A.SetBase("10.1.3.0", "255.255.255.0");
  Ipv4InterfaceContainer I2 = A.Assign(D2);
  A.SetBase("10.1.4.0", "255.255.255.0");
  Ipv4InterfaceContainer I3 = A.Assign(D3);
  A.SetBase("10.1.5.0", "255.255.255.0");
  Ipv4InterfaceContainer I4 = A.Assign(D4);

  Ipv4GlobalRoutingHelper::PopulateRoutingTables();


  uint16_t p = 9;
  UdpEchoServerHelper SV(p);
  ApplicationContainer Sa = SV.Install(N.Get(1));     // server on n1
  Sa.Start(Seconds(1));
  Sa.Stop (Seconds(10));

  UdpEchoClientHelper CL(I4.GetAddress(1), p);        // destination = n1 IP
  CL.SetAttribute("MaxPackets", UintegerValue(1));
  CL.SetAttribute("Interval", TimeValue(Seconds(1)));
  CL.SetAttribute("PacketSize", UintegerValue(1024));

  ApplicationContainer Ca = CL.Install(N.Get(0));     // client on n0
  Ca.Start(Seconds(2));
  Ca.Stop (Seconds(10));

  AnimationInterface anim("fifth.xml");
  anim.SetConstantPosition(N.Get(0), 100, 200);
  anim.SetConstantPosition(R.Get(0), 200, 200);
  anim.SetConstantPosition(R.Get(1), 300, 200);
  anim.SetConstantPosition(R.Get(2), 400, 200);
  anim.SetConstantPosition(R.Get(3), 500, 200);
  anim.SetConstantPosition(N.Get(1), 600, 200);

  AsciiTraceHelper ascii;
  P.EnableAsciiAll(ascii.CreateFileStream("5th.tr"));

  Simulator::Run();
  Simulator::Destroy();
  return 0;
}
