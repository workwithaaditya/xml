2)


include "ns3/core-module.h"
#include "ns3/network-module.h"
#include "ns3/internet-module.h"
#include "ns3/point-to-point-module.h"
#include "ns3/applications-module.h"
#include "ns3/netanim-module.h"
using namespace ns3;

int main (int argc, char *argv[])
{
  CommandLine C;
  C.Parse (argc, argv);

  NodeContainer N;
  N.Create (3);                       // 0 - 1 - 2

  PointToPointHelper P;
  P.SetDeviceAttribute ("DataRate", StringValue ("5Mbps"));
  P.SetChannelAttribute ("Delay", StringValue ("2ms"));

  InternetStackHelper S;
  S.Install (N);

  NetDeviceContainer D01 = P.Install (N.Get(0), N.Get(1));
  NetDeviceContainer D12 = P.Install (N.Get(1), N.Get(2));


  Ipv4AddressHelper A;
  A.SetBase ("10.1.1.0", "255.255.255.0");
  Ipv4InterfaceContainer I01 = A.Assign (D01);
  A.SetBase ("10.1.2.0", "255.255.255.0");
  Ipv4InterfaceContainer I12 = A.Assign (D12);

  uint16_t p = 9;


  UdpEchoServerHelper SV (p);
  ApplicationContainer Sa = SV.Install (N.Get(1));   // middle = server
  Sa.Start (Seconds(1));
  Sa.Stop  (Seconds(10));

  UdpEchoClientHelper C1 (I01.GetAddress(1), p);
  C1.SetAttribute ("MaxPackets", UintegerValue (1));
  C1.SetAttribute ("Interval", TimeValue (Seconds (1)));
  C1.SetAttribute ("PacketSize", UintegerValue (1024));
  ApplicationContainer Ca1 = C1.Install (N.Get(0));  // left client
  Ca1.Start (Seconds(2));
  Ca1.Stop  (Seconds(10));

  UdpEchoClientHelper C2 (I12.GetAddress(1), p);
  C2.SetAttribute ("MaxPackets", UintegerValue (1));
  C2.SetAttribute ("Interval", TimeValue (Seconds (1)));
  C2.SetAttribute ("PacketSize", UintegerValue (1024));
  ApplicationContainer Ca2 = C2.Install (N.Get(2));  // right client
  Ca2.Start (Seconds(2.5));
  Ca2.Stop  (Seconds(10));

  AnimationInterface anim ("p2p.xml");
  anim.SetConstantPosition (N.Get(0), 100, 200);
  anim.SetConstantPosition (N.Get(1), 200, 200);
  anim.SetConstantPosition (N.Get(2), 300, 200);

  AsciiTraceHelper ascii;
  P.EnableAsciiAll (ascii.CreateFileStream ("p2p.tr"));

  Simulator::Run ();
  Simulator::Destroy ();
  return 0;
}
